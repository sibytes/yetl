# yaml-language-server: $schema=./json_schema/sibytes_yetl_tables_schema.json

version: 2.0.0.dev3

audit_control:
  delta_lake:
    control_fnz_pb:
      base_audit:
        depends_on:
        - raw.raw_fnz_pb.*
        sql: ../sql/{{database}}/{{table}}.sql
        vacuum: 168
      header_footer:
        depends_on:
        - raw.raw_fnz_pb.*
        sql: ../sql/{{database}}/{{table}}.sql
        vacuum: 168
      raw_audit:
        depends_on:
        - raw.raw_fnz_pb.*
        - audit_control.control_fnz_pb.header_footer
        sql: ../sql/{{database}}/{{table}}.sql
        vacuum: 168

landing:
  read:
    landing_fnz_pb:
      balance: null
      balancepriceupdates: null
      balanceupdates: null
      price-deletesupdates: null
      price-inserts: null
      reconciliationprices: null

raw:
  delta_lake:
    raw_fnz_pb:
      balance_inserts:
        custom_properties:
          process_group: 1
          rentention_days: 365
        depends_on:
        - landing.landing_fnz_pb.balance
        exception_thresholds:
          invalid_rows: 2
      balance_price_updates:
        custom_properties:
          process_group: 1
          rentention_days: 365
        depends_on:
        - landing.landing_fnz_pb.balancepriceupdates
        exception_thresholds:
          invalid_rows: 2
      balance_updates:
        custom_properties:
          process_group: 1
          rentention_days: 365
        depends_on:
        - landing.landing_fnz_pb.balanceupdates
        exception_thresholds:
          invalid_rows: 2
      price_deletes_updates:
        custom_properties:
          process_group: 1
          rentention_days: 365
        depends_on:
        - landing.landing_fnz_pb.price-deletesupdates
        exception_thresholds:
          invalid_rows: 2
      price_inserts:
        custom_properties:
          process_group: 1
          rentention_days: 365
        depends_on:
        - landing.landing_fnz_pb.price-inserts
      reconciliation_prices:
        custom_properties:
          process_group: 1
          rentention_days: 365
        depends_on:
        - landing.landing_fnz_pb.reconciliationprices
        exception_thresholds:
          invalid_rows: 2

base:
  delta_lake:
    base_fnz_pb:
      balance:
        custom_properties:
          process_group: 1
          rentention_days: 365
        depends_on:
        - raw.raw_fnz_pb.balance_price_updates
        - raw.raw_fnz_pb.balance_updates
        - raw.raw_fnz_pb.balance_inserts
      balance_inserts:
        custom_properties:
          process_group: 1
          rentention_days: 365
        depends_on:
        - raw.raw_fnz_pb.balance_inserts
      balance_price_updates:
        custom_properties:
          process_group: 1
          rentention_days: 365
        depends_on:
        - raw.raw_fnz_pb.balance_price_updates
      balance_updates:
        custom_properties:
          process_group: 1
          rentention_days: 365
        depends_on:
        - raw.raw_fnz_pb.balance_updates
      price_deletes_updates:
        custom_properties:
          process_group: 1
          rentention_days: 365
        depends_on:
        - raw.raw_fnz_pb.price_deletes_updates
      price_inserts:
        custom_properties:
          process_group: 1
          rentention_days: 365
        depends_on:
        - raw.raw_fnz_pb.price_inserts
      reconciliation_prices:
        custom_properties:
          process_group: 1
          rentention_days: 365
        depends_on:
        - raw.raw_fnz_pb.reconciliation_prices

