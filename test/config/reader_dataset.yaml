database: demo_landing
table: customer_details  

properties:
  yetl.schema.createIfNotExists: True
  yetl.schema.corruptRecordName: _corrupt_record
  yetl.schema.corruptRecord: False
  yetl.metadata.contextId: True
  yetl.metadata.dataflowId: True
  yetl.metadata.datasetId: True
  yetl.metadata.timeslice: timeslice_file_date_format
  yetl.metadata.filepathFilename: True
  yetl.metadata.filepath: True
  yetl.metadata.filename: True


path_date_format: "%Y%m%d"
file_date_format: "%Y%m%d"
format: csv
path: "landing/demo/{{ timeslice_path_date_format }}/customer_details_{{ timeslice_file_date_format }}.csv"
read:
  auto: true
  options:
    mode: PERMISSIVE
    inferSchema: false
    header: true

exceptions: 
    path: "delta_lake/demo_landing/{{table_name}}_exceptions"
    database: demo_landing
    table: "{{table_name}}_exceptions"

thresholds: 
    warning: 
        min_rows: 1
        max_rows: 1000
        exception_count: 0
        exception_percent: 0
    
    error: 
        min_rows: 0
        max_rows: 100000000
        exception_count: 50
        exception_percent: 80
    
    