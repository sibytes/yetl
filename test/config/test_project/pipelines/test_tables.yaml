audit_control:
  delta_lake:
    raw_dbx_patterns_control:
      header_footer:
        depends_on: raw.raw_dbx_patterns.*
        partition_by: none
        sql: ../sql/{{database}}/{{table}}.sql
        vacuum: 30
      raw_audit:
        depends_on:
        - raw.raw_dbx_patterns.*
        - audit_control.raw_dbx_patterns_control.header_footer
        sql: ../sql/{{database}}/{{table}}.sql
        vacuum: 30
landing:
  read:
    landing_dbx_patterns:
      customer_details_1: null
      customer_details_2: null
raw:
  delta_lake:
    raw_dbx_patterns:
      customers:
        custom_properties:
          process_group: 1.0
          rentention_days: 365.0
        depends_on:
        - landing.landing_dbx_patterns.customer_details_1
        - landing.landing_dbx_patterns.customer_details_2
        error_thresholds:
          invalid_ratio: 0.2
          invalid_rows: 2.0
          max_rows: 1000.0
          mins_rows: 0.0
        ids: id
        vacuum: 30
        warning_thresholds:
          invalid_ratio: 0.1
          invalid_rows: 0.0
          max_rows: 100.0
          mins_rows: 5.0
        z_order_by: _load_date
base:
  delta_lake:
    base_dbx_patterns:
      customer_details_1:
        delta_properties:
          delta.appendOnly: true
          delta.autoOptimize.autoCompact: true
          delta.autoOptimize.optimizeWrite: true
          delta.enableChangeDataFeed: false
        depends_on: raw.raw_dbx_patterns.customers
        ids: id
        vacuum: 30
      customer_details_2:
        delta_properties:
          delta.appendOnly: true
          delta.autoOptimize.autoCompact: true
          delta.autoOptimize.optimizeWrite: true
          delta.enableChangeDataFeed: false
        depends_on: raw.raw_dbx_patterns.customers
        ids: id
        vacuum: 30
