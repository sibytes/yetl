INFO : 2022-08-15 09:42:20,457 : customer_landing_to_rawdb_csv : _config_provider.py.load_config: line(41) : Loading Dataflow configuration from file /Users/shaunryan/AzureDevOps/yetl/config/pipeline/local/config.yaml
DEBUG : 2022-08-15 09:42:20,459 : customer_landing_to_rawdb_csv : _config_provider.py.load_config: line(47) : {
    "datalake": "/Users/shaunryan/AzureDevOps/yetl",
    "datalake_protocol": "file:",
    "deltalake_schema_repo": {
        "deltalake_sql_file": {
            "deltalake_schema_root": "./config/schema/deltalake"
        }
    },
    "spark": {
        "park.sql.extensions": "io.delta.sql.DeltaSparkSessionExtension",
        "spark.jars.packages": "io.delta:delta-core_2.12:2.0.0",
        "spark.master": "local",
        "spark.sql.catalog.spark_catalog": "org.apache.spark.sql.delta.catalog.DeltaCatalog"
    },
    "spark_schema_repo": {
        "spark_schema_file": {
            "spark_schema_root": "./config/schema/spark"
        }
    }
}
INFO : 2022-08-15 09:42:20,459 : customer_landing_to_rawdb_csv : _context.py._get_spark_context: line(86) : Setting spark context
DEBUG : 2022-08-15 09:42:20,459 : customer_landing_to_rawdb_csv : _context.py._get_spark_context: line(90) : {
    "spark.master": "local",
    "spark.jars.packages": "io.delta:delta-core_2.12:2.0.0",
    "park.sql.extensions": "io.delta.sql.DeltaSparkSessionExtension",
    "spark.sql.catalog.spark_catalog": "org.apache.spark.sql.delta.catalog.DeltaCatalog"
}
:: loading settings :: url = jar:file:/Users/shaunryan/opt/spark-3.2.1-bin-hadoop3.2/jars/ivy-2.5.0.jar!/org/apache/ivy/core/settings/ivysettings.xml
INFO : 2022-08-15 09:42:24,983 : customer_landing_to_rawdb_csv : _context.py.__init__: line(51) : Setting application context spark logger at level ERROR
INFO : 2022-08-15 09:42:24,986 : customer_landing_to_rawdb_csv : _factory.py.get_file_system_type: line(50) : Setting filestystem using protocol file:
DEBUG : 2022-08-15 09:42:24,986 : customer_landing_to_rawdb_csv : _factory.py.get_file_system_type: line(51) : Setting FileSystemType using type FileSystemType.FILE
INFO : 2022-08-15 09:42:24,986 : customer_landing_to_rawdb_csv : _context.py.__init__: line(67) : Setting application context dataflow customer_landing_to_rawdb_csv
INFO : 2022-08-15 09:42:24,987 : customer_landing_to_rawdb_csv : _config_provider.py.load_pipeline_config: line(29) : Loading Dataflow configuration from file /Users/shaunryan/AzureDevOps/yetl/config/pipeline/local/customer_landing_to_rawdb_csv.yaml
DEBUG : 2022-08-15 09:42:25,003 : customer_landing_to_rawdb_csv : _config_provider.py.load_pipeline_config: line(33) : {
    "dataflow": {
        "landing": {
            "customer": {
                "exceptions": {
                    "database": "landing",
                    "path": "data/delta_lake/exceptions",
                    "table": "exceptions"
                },
                "file_date_format": "%Y%m%d",
                "format": "csv",
                "path": "data/landing/{{timeslice(path_date_format)}}/customer_{{timeslice(file_date_format)}}.csv",
                "path_date_format": "%Y%m%d",
                "read": {
                    "auto": true,
                    "options": {
                        "header": true,
                        "inferSchema": false,
                        "mode": "PERMISSIVE"
                    }
                },
                "table": null,
                "thresholds": {
                    "error": {
                        "exception_count": 50,
                        "exception_percent": 80,
                        "max_rows": 100000000,
                        "min_rows": 0
                    },
                    "warning": {
                        "exception_count": 0,
                        "exception_percent": 0,
                        "max_rows": 1000,
                        "min_rows": 1
                    }
                }
            },
            "customer_preferences": {
                "exceptions": {
                    "database": "landing",
                    "path": "data/delta_lake/exceptions",
                    "table": "exceptions"
                },
                "file_date_format": "%Y%m%d",
                "format": "csv",
                "path": "data/landing/{{timeslice(path_date_format)}}/customer_preferences_{{timeslice(file_date_format)}}.csv",
                "path_date_format": "%Y%m%d",
                "read": {
                    "options": {
                        "header": true,
                        "inferSchema": false,
                        "mode": "PERMISSIVE"
                    }
                },
                "table": null,
                "thresholds": {
                    "error": {
                        "exception_count": 50,
                        "exception_percent": 80,
                        "max_rows": 100000000,
                        "min_rows": 0
                    },
                    "warning": {
                        "exception_count": 0,
                        "exception_percent": 0,
                        "max_rows": 1000,
                        "min_rows": 0
                    }
                }
            }
        },
        "raw": {
            "customer": {
                "format": "delta",
                "path": "data/delta_lake/raw/customer",
                "table": {
                    "check_constraints": {
                        "amount_lower_bound": "amount > -1000",
                        "amount_upper_bound": "amount < 10000"
                    },
                    "ddl": "./config/schema/deltalake",
                    "partition_by": [
                        "_PARTITION_KEY"
                    ],
                    "properties": {
                        "delta.appendOnly": false,
                        "delta.checkpoint.writeStatsAsJson": true,
                        "delta.compatibility.symlinkFormatManifest.enabled": false,
                        "delta.dataSkippingNumIndexedCols": -1,
                        "delta.deletedFileRetentionDuration": "interval 1 week",
                        "delta.enableChangeDataFeed": true,
                        "delta.logRetentionDuration": "interval 30 days",
                        "delta.minReaderVersion": 1,
                        "delta.minWriterVersion": 2,
                        "delta.randomPrefixLength": 2,
                        "delta.randomizeFilePrefixes": false,
                        "yetl.allowRepartitioning": true,
                        "yetl.lineagecolumn.correlation_id": "_CORRELATION_ID",
                        "yetl.lineagecolumn.filename": "_FILENAME",
                        "yetl.lineagecolumn.loadtimestamp": "_LOAD_TIMESTAMP",
                        "yetl.lineagecolumn.timeslice": "_TIMESLICE"
                    }
                },
                "write": {
                    "mode": "append",
                    "options": {
                        "mergeSchema": true
                    }
                }
            }
        },
        "retries": 0,
        "retry_wait": 1
    }
}
DEBUG : 2022-08-15 09:42:25,003 : customer_landing_to_rawdb_csv : _context.py._get_deltalake_flow: line(79) : Deserializing configuration into Dataflow
DEBUG : 2022-08-15 09:42:25,003 : customer_landing_to_rawdb_csv : _i_dataflow.py.__init__: line(18) : initialise dataflow with config
DEBUG : 2022-08-15 09:42:25,003 : customer_landing_to_rawdb_csv : _i_dataflow.py.__init__: line(19) : {
    "datalake": "/Users/shaunryan/AzureDevOps/yetl",
    "datalake_protocol": "file:",
    "spark": {
        "spark.master": "local",
        "spark.jars.packages": "io.delta:delta-core_2.12:2.0.0",
        "park.sql.extensions": "io.delta.sql.DeltaSparkSessionExtension",
        "spark.sql.catalog.spark_catalog": "org.apache.spark.sql.delta.catalog.DeltaCatalog"
    },
    "spark_schema_repo": {
        "spark_schema_file": {
            "spark_schema_root": "./config/schema/spark"
        }
    },
    "deltalake_schema_repo": {
        "deltalake_sql_file": {
            "deltalake_schema_root": "./config/schema/deltalake"
        }
    }
}
DEBUG : 2022-08-15 09:42:25,003 : customer_landing_to_rawdb_csv : _i_dataflow.py.__init__: line(21) : initialise dataflow with dataflow_config
DEBUG : 2022-08-15 09:42:25,003 : customer_landing_to_rawdb_csv : _i_dataflow.py.__init__: line(22) : {
    "retries": 0,
    "retry_wait": 1,
    "landing": {
        "customer": {
            "table": null,
            "path_date_format": "%Y%m%d",
            "file_date_format": "%Y%m%d",
            "format": "csv",
            "path": "data/landing/{{timeslice(path_date_format)}}/customer_{{timeslice(file_date_format)}}.csv",
            "read": {
                "auto": true,
                "options": {
                    "mode": "PERMISSIVE",
                    "inferSchema": false,
                    "header": true
                }
            },
            "exceptions": {
                "path": "data/delta_lake/exceptions",
                "database": "landing",
                "table": "exceptions"
            },
            "thresholds": {
                "warning": {
                    "min_rows": 1,
                    "max_rows": 1000,
                    "exception_count": 0,
                    "exception_percent": 0
                },
                "error": {
                    "min_rows": 0,
                    "max_rows": 100000000,
                    "exception_count": 50,
                    "exception_percent": 80
                }
            }
        },
        "customer_preferences": {
            "table": null,
            "path_date_format": "%Y%m%d",
            "file_date_format": "%Y%m%d",
            "format": "csv",
            "path": "data/landing/{{timeslice(path_date_format)}}/customer_preferences_{{timeslice(file_date_format)}}.csv",
            "read": {
                "options": {
                    "mode": "PERMISSIVE",
                    "inferSchema": false,
                    "header": true
                }
            },
            "exceptions": {
                "path": "data/delta_lake/exceptions",
                "database": "landing",
                "table": "exceptions"
            },
            "thresholds": {
                "warning": {
                    "min_rows": 0,
                    "max_rows": 1000,
                    "exception_count": 0,
                    "exception_percent": 0
                },
                "error": {
                    "min_rows": 0,
                    "max_rows": 100000000,
                    "exception_count": 50,
                    "exception_percent": 80
                }
            }
        }
    },
    "raw": {
        "customer": {
            "table": {
                "partition_by": [
                    "_PARTITION_KEY"
                ],
                "ddl": "./config/schema/deltalake",
                "properties": {
                    "yetl.allowRepartitioning": true,
                    "yetl.lineagecolumn.loadtimestamp": "_LOAD_TIMESTAMP",
                    "yetl.lineagecolumn.timeslice": "_TIMESLICE",
                    "yetl.lineagecolumn.correlation_id": "_CORRELATION_ID",
                    "yetl.lineagecolumn.filename": "_FILENAME",
                    "delta.appendOnly": false,
                    "delta.checkpoint.writeStatsAsJson": true,
                    "delta.compatibility.symlinkFormatManifest.enabled": false,
                    "delta.dataSkippingNumIndexedCols": -1,
                    "delta.logRetentionDuration": "interval 30 days",
                    "delta.deletedFileRetentionDuration": "interval 1 week",
                    "delta.enableChangeDataFeed": true,
                    "delta.minReaderVersion": 1,
                    "delta.minWriterVersion": 2,
                    "delta.randomizeFilePrefixes": false,
                    "delta.randomPrefixLength": 2
                },
                "check_constraints": {
                    "amount_lower_bound": "amount > -1000",
                    "amount_upper_bound": "amount < 10000"
                }
            },
            "format": "delta",
            "path": "data/delta_lake/raw/customer",
            "write": {
                "mode": "append",
                "options": {
                    "mergeSchema": true
                }
            }
        }
    }
}
INFO : 2022-08-15 09:42:25,004 : customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on spark_schema_file 
DEBUG : 2022-08-15 09:42:25,005 : customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(41) : Setting SchemaRepoType using type SchemaRepoType.SPARK_SCHEMA_FILE
DEBUG : 2022-08-15 09:42:25,005 : customer_landing_to_rawdb_csv : _factory.py.get_file_system_type: line(57) : Setting FileSystemType using type FileSystemType.FILE
INFO : 2022-08-15 09:42:25,005 : customer_landing_to_rawdb_csv : _spark_file_schema_repo.py.load_schema: line(50) : Loading schema for dataset landing.customer from /Users/shaunryan/AzureDevOps/yetl/config/schema/spark/landing/customer.yaml using <class 'yetl_flow.file_system._file_system.FileSystem'>
DEBUG : 2022-08-15 09:42:25,009 : customer_landing_to_rawdb_csv : _spark_file_schema_repo.py.load_schema: line(59) : {
    "type": "struct",
    "fields": [
        {
            "metadata": {},
            "name": "id",
            "nullable": false,
            "type": "integer"
        },
        {
            "metadata": {},
            "name": "first_name",
            "nullable": false,
            "type": "string"
        },
        {
            "metadata": {},
            "name": "last_name",
            "nullable": true,
            "type": "string"
        },
        {
            "metadata": {},
            "name": "email",
            "nullable": true,
            "type": "string"
        },
        {
            "metadata": {},
            "name": "gender",
            "nullable": true,
            "type": "string"
        },
        {
            "metadata": {},
            "name": "job_title",
            "nullable": true,
            "type": "string"
        },
        {
            "metadata": {},
            "name": "amount",
            "nullable": true,
            "type": "double"
        },
        {
            "metadata": {},
            "name": "_corrupt_record",
            "nullable": true,
            "type": "string"
        }
    ]
}
INFO : 2022-08-15 09:42:25,009 : customer_landing_to_rawdb_csv : _reader.py.__init__: line(49) : auto_io = True automatically creating or altering exception delta table landing.customer _correlation_id=60694854-b241-4845-bda6-11c646a124ff
INFO : 2022-08-15 09:42:25,009 : customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `landing`
DEBUG : 2022-08-15 09:42:25,009 : customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(29) : CREATE DATABASE IF NOT EXISTS landing
INFO : 2022-08-15 09:42:32,089 : customer_landing_to_rawdb_csv : _delta_lake.py.create_table: line(16) : Creating table if not exists landing.exceptions at file:/Users/shaunryan/AzureDevOps/yetl/data/delta_lake/exceptions/landing/exceptions
DEBUG : 2022-08-15 09:42:38,981 : customer_landing_to_rawdb_csv : _dataflow.py.__init__: line(47) : Deserialized landing.customer configuration into <class 'yetl_flow.dataset._reader.Reader'>
DEBUG : 2022-08-15 09:42:38,981 : customer_landing_to_rawdb_csv : _dataflow.py.append: line(55) : Appending source landing.customer as <class 'yetl_flow.dataset._reader.Reader'> to dataflow
INFO : 2022-08-15 09:42:38,981 : customer_landing_to_rawdb_csv : _reader.py.read: line(200) : Reading data for landing.customer from file:/Users/shaunryan/AzureDevOps/yetl/data/landing/2022**/customer_2022**.csv with options {'mode': 'PERMISSIVE', 'inferSchema': False, 'header': True} _correlation_id=60694854-b241-4845-bda6-11c646a124ff
DEBUG : 2022-08-15 09:42:38,981 : customer_landing_to_rawdb_csv : _reader.py.read: line(204) : {
    "mode": "PERMISSIVE",
    "inferSchema": false,
    "header": true
}
INFO : 2022-08-15 09:42:39,099 : customer_landing_to_rawdb_csv : _reader.py.validate: line(182) : Validating dataframe read using PERMISSIVE corrupt column at _corrupt_record _correlation_id=60694854-b241-4845-bda6-11c646a124ff
INFO : 2022-08-15 09:42:39,737 : customer_landing_to_rawdb_csv : _reader.py.validate: line(197) : {
    "validation": {
        "schema_on_read": {
            "landing.customer": {
                "total_count": 20,
                "valid_count": 20,
                "exception_count": 0
            }
        }
    }
}
INFO : 2022-08-15 09:42:39,737 : customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on spark_schema_file 
DEBUG : 2022-08-15 09:42:39,737 : customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(41) : Setting SchemaRepoType using type SchemaRepoType.SPARK_SCHEMA_FILE
DEBUG : 2022-08-15 09:42:39,737 : customer_landing_to_rawdb_csv : _factory.py.get_file_system_type: line(57) : Setting FileSystemType using type FileSystemType.FILE
INFO : 2022-08-15 09:42:39,737 : customer_landing_to_rawdb_csv : _spark_file_schema_repo.py.load_schema: line(50) : Loading schema for dataset landing.customer_preferences from /Users/shaunryan/AzureDevOps/yetl/config/schema/spark/landing/customer_preferences.yaml using <class 'yetl_flow.file_system._file_system.FileSystem'>
DEBUG : 2022-08-15 09:42:39,739 : customer_landing_to_rawdb_csv : _spark_file_schema_repo.py.load_schema: line(59) : {
    "type": "struct",
    "fields": [
        {
            "metadata": {},
            "name": "id",
            "nullable": false,
            "type": "integer"
        },
        {
            "metadata": {},
            "name": "allow_contact",
            "nullable": false,
            "type": "boolean"
        },
        {
            "metadata": {},
            "name": "_corrupt_record",
            "nullable": true,
            "type": "string"
        }
    ]
}
INFO : 2022-08-15 09:42:39,740 : customer_landing_to_rawdb_csv : _reader.py.__init__: line(49) : auto_io = True automatically creating or altering exception delta table landing.customer_preferences _correlation_id=60694854-b241-4845-bda6-11c646a124ff
INFO : 2022-08-15 09:42:39,740 : customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `landing`
DEBUG : 2022-08-15 09:42:39,740 : customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(29) : CREATE DATABASE IF NOT EXISTS landing
INFO : 2022-08-15 09:42:39,848 : customer_landing_to_rawdb_csv : _reader.py.create_or_alter_table: line(61) : Exception table already exists landing.exceptions at file:/Users/shaunryan/AzureDevOps/yetl/data/delta_lake/exceptions/landing/exceptions _correlation_id=60694854-b241-4845-bda6-11c646a124ff
DEBUG : 2022-08-15 09:42:39,848 : customer_landing_to_rawdb_csv : _dataflow.py.__init__: line(47) : Deserialized landing.customer_preferences configuration into <class 'yetl_flow.dataset._reader.Reader'>
DEBUG : 2022-08-15 09:42:39,848 : customer_landing_to_rawdb_csv : _dataflow.py.append: line(55) : Appending source landing.customer_preferences as <class 'yetl_flow.dataset._reader.Reader'> to dataflow
INFO : 2022-08-15 09:42:39,848 : customer_landing_to_rawdb_csv : _reader.py.read: line(200) : Reading data for landing.customer_preferences from file:/Users/shaunryan/AzureDevOps/yetl/data/landing/2022**/customer_preferences_2022**.csv with options {'mode': 'PERMISSIVE', 'inferSchema': False, 'header': True} _correlation_id=60694854-b241-4845-bda6-11c646a124ff
DEBUG : 2022-08-15 09:42:39,848 : customer_landing_to_rawdb_csv : _reader.py.read: line(204) : {
    "mode": "PERMISSIVE",
    "inferSchema": false,
    "header": true
}
INFO : 2022-08-15 09:42:39,881 : customer_landing_to_rawdb_csv : _reader.py.validate: line(182) : Validating dataframe read using PERMISSIVE corrupt column at _corrupt_record _correlation_id=60694854-b241-4845-bda6-11c646a124ff
INFO : 2022-08-15 09:42:40,193 : customer_landing_to_rawdb_csv : _reader.py.validate: line(197) : {
    "validation": {
        "schema_on_read": {
            "landing.customer_preferences": {
                "total_count": 20,
                "valid_count": 20,
                "exception_count": 0
            }
        }
    }
}
INFO : 2022-08-15 09:42:40,193 : customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(39) : Setting up schema repo on deltalake_sql_file 
DEBUG : 2022-08-15 09:42:40,193 : customer_landing_to_rawdb_csv : _factory.py.get_schema_repo_type: line(41) : Setting SchemaRepoType using type SchemaRepoType.DELTALAKE_SQL_FILE
DEBUG : 2022-08-15 09:42:40,194 : customer_landing_to_rawdb_csv : _factory.py.get_file_system_type: line(57) : Setting FileSystemType using type FileSystemType.FILE
INFO : 2022-08-15 09:42:40,194 : customer_landing_to_rawdb_csv : _deltalake_sql_file.py.load_schema: line(43) : Loading schema for dataset raw.customer from ./config/schema/deltalake/raw/customer.sql using <class 'yetl_flow.file_system._file_system.FileSystem'>
DEBUG : 2022-08-15 09:42:40,194 : customer_landing_to_rawdb_csv : _deltalake_sql_file.py.load_schema: line(53) : "CREATE TABLE {{database_name}}.{{table_name}}\n(\n    id            integer not null,\n    first_name    string not null,\n    last_name     string,\n    email         string,\n    gender        string,\n    job_title     string,\n    amount        double,\n    allow_contact boolean,\n    _PARTITION_KEY int\n)\nUSING DELTA LOCATION '{{path}}';\n-- PARTITION BY ()"
DEBUG : 2022-08-15 09:42:40,194 : customer_landing_to_rawdb_csv : _writer.py.__init__: line(22) : Writer table ddl = CREATE TABLE raw.customer
(
    id            integer not null,
    first_name    string not null,
    last_name     string,
    email         string,
    gender        string,
    job_title     string,
    amount        double,
    allow_contact boolean,
    _PARTITION_KEY int
)
USING DELTA LOCATION 'file:/Users/shaunryan/AzureDevOps/yetl/data/delta_lake/raw/customer';
-- PARTITION BY ()
INFO : 2022-08-15 09:42:40,194 : customer_landing_to_rawdb_csv : _writer.py.__init__: line(40) : auto_io = True automatically creating or altering delta table raw.customer
INFO : 2022-08-15 09:42:40,194 : customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(27) : Creating database if not exists `raw`
DEBUG : 2022-08-15 09:42:40,194 : customer_landing_to_rawdb_csv : _delta_lake.py.create_database: line(29) : CREATE DATABASE IF NOT EXISTS raw
INFO : 2022-08-15 09:42:40,276 : customer_landing_to_rawdb_csv : _delta_lake.py.create_table: line(16) : Creating table if not exists raw.customer at file:/Users/shaunryan/AzureDevOps/yetl/data/delta_lake/raw/customer
DEBUG : 2022-08-15 09:42:42,722 : customer_landing_to_rawdb_csv : _writer.py._set_table_constraints: line(57) : Writer table check constraints ddl = ['ALTER TABLE `raw`.`customer` ADD CONSTRAINT amount_lower_bound CHECK (amount > -1000);', 'ALTER TABLE `raw`.`customer` ADD CONSTRAINT amount_upper_bound CHECK (amount < 10000);']
ERROR : 2022-08-15 09:42:46,245 : root : java_gateway.py.send_command: line(1055) : Exception while sending command.
Traceback (most recent call last):
  File "/Users/shaunryan/AzureDevOps/yetl/venv/lib/python3.8/site-packages/py4j/clientserver.py", line 475, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
RuntimeError: reentrant call inside <_io.BufferedReader name=3>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/shaunryan/AzureDevOps/yetl/venv/lib/python3.8/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/Users/shaunryan/AzureDevOps/yetl/venv/lib/python3.8/site-packages/py4j/clientserver.py", line 503, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
ERROR : 2022-08-15 09:42:46,247 : root : java_gateway.py.send_command: line(1055) : Exception while sending command.
Traceback (most recent call last):
  File "/Users/shaunryan/AzureDevOps/yetl/venv/lib/python3.8/site-packages/py4j/clientserver.py", line 475, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "/Users/shaunryan/.pyenv/versions/3.8.11/lib/python3.8/socket.py", line 669, in readinto
    return self._sock.recv_into(b)
  File "/Users/shaunryan/AzureDevOps/yetl/venv/lib/python3.8/site-packages/pyspark/context.py", line 292, in signal_handler
    self.cancelAllJobs()
  File "/Users/shaunryan/AzureDevOps/yetl/venv/lib/python3.8/site-packages/pyspark/context.py", line 1195, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "/Users/shaunryan/AzureDevOps/yetl/venv/lib/python3.8/site-packages/py4j/java_gateway.py", line 1321, in __call__
    return_value = get_return_value(
  File "/Users/shaunryan/AzureDevOps/yetl/venv/lib/python3.8/site-packages/pyspark/sql/utils.py", line 111, in deco
    return f(*a, **kw)
  File "/Users/shaunryan/AzureDevOps/yetl/venv/lib/python3.8/site-packages/py4j/protocol.py", line 334, in get_return_value
    raise Py4JError(
py4j.protocol.Py4JError: An error occurred while calling o26.sc

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/shaunryan/AzureDevOps/yetl/venv/lib/python3.8/site-packages/py4j/java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "/Users/shaunryan/AzureDevOps/yetl/venv/lib/python3.8/site-packages/py4j/clientserver.py", line 503, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
