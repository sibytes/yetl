22/10/06 12:57:45 WARN Utils: Your hostname, Shauns-MacBook-Pro.local resolves to a loopback address: 127.0.0.1; using 192.168.0.16 instead (on interface en0)
22/10/06 12:57:45 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
:: loading settings :: url = jar:file:/Users/shaunryan/opt/spark-3.3.0-bin-hadoop3/jars/ivy-2.5.0.jar!/org/apache/ivy/core/settings/ivysettings.xml
22/10/06 12:57:46 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
You are setting a property: delta.autoOptimize.autoCompact that is not recognized by this version of Delta
You are setting a property: delta.autoOptimize.optimizeWrite that is not recognized by this version of Delta
{
    "dataflow": {
        "datasets": {
            "e2e4b02e-6930-420a-a75b-a945c180781a": {
                "type": "Reader",
                "dataflow_id": "d4f79c71-5253-4103-99c4-369019637fa2",
                "database": "landing",
                "table": "customer",
                "path": "file:/Users/shaunryan/AzureDevOps/yetl/data/landing/2022**/customer_2022**.csv",
                "tasks": {
                    "0": {
                        "task": "sql",
                        "message": "CREATE TABLE IF NOT EXISTS `landing`.`exceptions` USING DELTA LOCATION 'file:/Users/shaunryan/AzureDevOps/yetl/data/delta_lake/exceptions/landing/exceptions';",
                        "start_datetime": "2022-10-06 12:57:58",
                        "end_datetime": "2022-10-06 12:58:07",
                        "seconds_duration": 9.273305
                    },
                    "1": {
                        "task": "lazy_read",
                        "message": {
                            "path": "file:/Users/shaunryan/AzureDevOps/yetl/data/landing/2022**/customer_2022**.csv",
                            "options": {
                                "mode": "PERMISSIVE",
                                "inferSchema": false,
                                "header": true
                            }
                        },
                        "start_datetime": "2022-10-06 12:58:07",
                        "end_datetime": "2022-10-06 12:58:07",
                        "seconds_duration": 0.172829
                    },
                    "2": {
                        "task": "schema_on_read_validation",
                        "message": {
                            "validation": {
                                "thresholds": {
                                    "warning": {
                                        "min_rows": 1,
                                        "max_rows": 1000,
                                        "exception_count": 0,
                                        "exception_percent": 0
                                    },
                                    "error": {
                                        "min_rows": 0,
                                        "max_rows": 100000000,
                                        "exception_count": 50,
                                        "exception_percent": 80
                                    }
                                },
                                "schema_on_read": {
                                    "landing.customer": {
                                        "total_count": 20,
                                        "valid_count": 20,
                                        "exception_count": 0,
                                        "exception_percent": 0.0
                                    }
                                }
                            }
                        },
                        "start_datetime": "2022-10-06 12:58:07",
                        "end_datetime": "2022-10-06 12:58:08",
                        "seconds_duration": 0.870145
                    }
                }
            },
            "03a3a8e2-7ad8-482d-8c4a-bbd98eb95478": {
                "type": "Reader",
                "dataflow_id": "d4f79c71-5253-4103-99c4-369019637fa2",
                "database": "landing",
                "table": "customer_preferences",
                "path": "file:/Users/shaunryan/AzureDevOps/yetl/data/landing/2022**/customer_preferences_2022**.csv",
                "tasks": {
                    "0": {
                        "task": "lazy_read",
                        "message": {
                            "path": "file:/Users/shaunryan/AzureDevOps/yetl/data/landing/2022**/customer_preferences_2022**.csv",
                            "options": {
                                "mode": "PERMISSIVE",
                                "inferSchema": false,
                                "header": true
                            }
                        },
                        "start_datetime": "2022-10-06 12:58:08",
                        "end_datetime": "2022-10-06 12:58:08",
                        "seconds_duration": 0.025772
                    },
                    "1": {
                        "task": "schema_on_read_validation",
                        "message": {
                            "validation": {
                                "thresholds": {
                                    "warning": {
                                        "min_rows": 0,
                                        "max_rows": 1000,
                                        "exception_count": 0,
                                        "exception_percent": 0
                                    },
                                    "error": {
                                        "min_rows": 0,
                                        "max_rows": 100000000,
                                        "exception_count": 50,
                                        "exception_percent": 80
                                    }
                                },
                                "schema_on_read": {
                                    "landing.customer_preferences": {
                                        "total_count": 20,
                                        "valid_count": 20,
                                        "exception_count": 0,
                                        "exception_percent": 0.0
                                    }
                                }
                            }
                        },
                        "start_datetime": "2022-10-06 12:58:08",
                        "end_datetime": "2022-10-06 12:58:09",
                        "seconds_duration": 0.463003
                    }
                }
            },
            "8411605f-748f-46b6-89d1-929ddebefd12": {
                "type": "Writer",
                "dataflow_id": "d4f79c71-5253-4103-99c4-369019637fa2",
                "database": "raw",
                "table": "customer",
                "path": "file:/Users/shaunryan/AzureDevOps/yetl/data/delta_lake/raw/customer",
                "tasks": {
                    "0": {
                        "task": "sql",
                        "message": "CREATE DATABASE IF NOT EXISTS raw",
                        "start_datetime": "2022-10-06 12:58:09",
                        "end_datetime": "2022-10-06 12:58:09",
                        "seconds_duration": 0.182751
                    },
                    "1": {
                        "task": "sql",
                        "message": "CREATE TABLE raw.customer ( id integer not null, first_name string not null, last_name string, email string, gender string, job_title string, amount double, allow_contact boolean, _partition_key int, _context_id string, _timeslice timestamp ) USING DELTA LOCATION 'file:/Users/shaunryan/AzureDevOps/yetl/data/delta_lake/raw/customer' PARTITIONED BY (_partition_key,allow_contact);",
                        "start_datetime": "2022-10-06 12:58:09",
                        "end_datetime": "2022-10-06 12:58:13",
                        "seconds_duration": 3.836908
                    },
                    "2": {
                        "task": "set_table_properties",
                        "message": [
                            "ALTER TABLE `raw`.`customer` ADD CONSTRAINT amount_lower_bound CHECK (amount > -1000);",
                            "ALTER TABLE `raw`.`customer` ADD CONSTRAINT amount_upper_bound CHECK (amount < 10000);"
                        ],
                        "start_datetime": "2022-10-06 12:58:13",
                        "end_datetime": "2022-10-06 12:58:20",
                        "seconds_duration": 7.115609
                    },
                    "3": {
                        "task": "set_table_properties",
                        "message": "ALTER TABLE `raw`.`customer` SET TBLPROPERTIES ('delta.appendOnly' = 'False', 'delta.checkpoint.writeStatsAsJson' = 'True', 'delta.autoOptimize.autoCompact' = 'True', 'delta.autoOptimize.optimizeWrite' = 'True', 'delta.compatibility.symlinkFormatManifest.enabled' = 'False', 'delta.dataSkippingNumIndexedCols' = '-1', 'delta.logRetentionDuration' = 'interval 30 days', 'delta.deletedFileRetentionDuration' = 'interval 1 week', 'delta.enableChangeDataFeed' = 'True', 'delta.minReaderVersion' = '1', 'delta.minWriterVersion' = '2', 'delta.randomizeFilePrefixes' = 'False', 'delta.randomPrefixLength' = '2');",
                        "start_datetime": "2022-10-06 12:58:20",
                        "end_datetime": "2022-10-06 12:58:23",
                        "seconds_duration": 2.611671
                    },
                    "4": {
                        "task": "delta_table_write",
                        "message": {
                            "version": 4,
                            "timestamp": "2022-10-06 12:58:26.165000",
                            "userId": null,
                            "userName": null,
                            "operation": "WRITE",
                            "operationParameters": {
                                "mode": "Overwrite",
                                "partitionBy": "[\"_partition_key\",\"allow_contact\"]"
                            },
                            "job": null,
                            "notebook": null,
                            "clusterId": null,
                            "readVersion": 3,
                            "isolationLevel": "Serializable",
                            "isBlindAppend": false,
                            "operationMetrics": {
                                "numOutputRows": "20",
                                "numOutputBytes": "13107",
                                "numFiles": "4"
                            },
                            "userMetadata": null,
                            "engineInfo": "Apache-Spark/3.3.0 Delta-Lake/2.1.0"
                        },
                        "start_datetime": "2022-10-06 12:58:23",
                        "end_datetime": "2022-10-06 12:58:29",
                        "seconds_duration": 6.282688
                    },
                    "5": {
                        "task": "delta_table_optimize",
                        "message": {
                            "version": 5,
                            "timestamp": "2022-10-06 12:58:32.273000",
                            "userId": null,
                            "userName": null,
                            "operation": "OPTIMIZE",
                            "operationParameters": {
                                "predicate": "[\"((_partition_key IN (20220711, 20220712)) AND (allow_contact IN (false, true)))\"]",
                                "zOrderBy": "[\"email\",\"id\"]"
                            },
                            "job": null,
                            "notebook": null,
                            "clusterId": null,
                            "readVersion": 4,
                            "isolationLevel": "SnapshotIsolation",
                            "isBlindAppend": false,
                            "operationMetrics": {
                                "numRemovedBytes": "13107",
                                "p50FileSize": "3302",
                                "p25FileSize": "3233",
                                "numAddedFiles": "4",
                                "minFileSize": "3201",
                                "p75FileSize": "3371",
                                "numAddedBytes": "13107",
                                "maxFileSize": "3371",
                                "numRemovedFiles": "4"
                            },
                            "userMetadata": null,
                            "engineInfo": "Apache-Spark/3.3.0 Delta-Lake/2.1.0"
                        },
                        "start_datetime": "2022-10-06 12:58:29",
                        "end_datetime": "2022-10-06 12:58:35",
                        "seconds_duration": 5.50677
                    }
                }
            }
        },
        "name": "batch_text_csv_to_delta_permissive_1",
        "args": {
            "timeslice": "2022-*-* 00:00:00.000000",
            "save": "<class 'yetl_flow.save._saves.OverwriteSave'>"
        },
        "started": "2022-10-06 12:57:43",
        "started_utc": "2022-10-06 12:57:43",
        "context_id": "51cc0b61-360e-486b-8598-e3d273f9ffd6",
        "lineage": {
            "d4f79c71-5253-4103-99c4-369019637fa2": {
                "8411605f-748f-46b6-89d1-929ddebefd12": {
                    "depends_on": [
                        "e2e4b02e-6930-420a-a75b-a945c180781a",
                        "03a3a8e2-7ad8-482d-8c4a-bbd98eb95478"
                    ]
                }
            }
        },
        "finished": "2022-10-06 12:58:35",
        "finished_utc": "2022-10-06 12:58:35"
    },
    "warning": {
        "count": 0
    },
    "error": {
        "count": 0
    }
}
